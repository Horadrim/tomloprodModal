/*! tomloprodModal - v1.0.1 - 2016-09-10
* Copyright (c) 2016 Tomas Lopez; Licensed MIT */
var TomloprodModal=function(){"use strict";function a(a,b,c){[].forEach.call(a,function(a){a.style[b]=c})}function b(a,b){return a.classList?a.classList.contains(b):new RegExp("(^| )"+b+"( |$)","gi").test(a.className)}function c(a,b){a.classList?a.classList.add(b):a.className+=" "+b}function d(a,b){var c=0,d=a.length;for(c=0;c<d;c+=1)if(a[c].toString()===b.toString())return c;return-1}function e(a,b){a.classList?a.classList.remove(b):void 0!==a.className&&(a.className=a.className.replace(new RegExp("(^|\\b)"+b.split(" ").join("|")+"(\\b|$)","gi")," "))}function f(a,b,c){a.style.left=b+"px",a.style.top=c+"px",p&&console.info("TomloprodModal: Dragging. Coord X: "+b+"px | Coord Y: "+c+"px")}function g(a){a=a||window.event,27===a.keyCode&&TomloprodModal.closeModal()}function h(a,b){void 0!==a&&(TomloprodModal.modal.id===a.target.getAttribute("data-tm-modal")?TomloprodModal.closeModal():TomloprodModal.openModal(a.target.getAttribute("data-tm-modal")),b.preventDefault())}var i=null,j=!0,k=!0,l=!0,m=!1,n={},o=[],p=!1,q=null;return{modal:[],isOpen:!1,openModal:function(d){if(TomloprodModal.isOpen&&TomloprodModal.closeModal(),TomloprodModal.modal=document.getElementById(d),TomloprodModal.modal){o&&c(o,"tm-effect");for(var e=null,f=0;f<TomloprodModal.modal.attributes.length;f++)if(e=TomloprodModal.modal.attributes[f],/^data-/.test(e.nodeName))switch(e.nodeName){case"data-tm-content":TomloprodModal.modal.getElementsByClassName("tm-content")[0].innerHTML=e.nodeValue;break;case"data-tm-title":TomloprodModal.modal.getElementsByClassName("tm-title-text")[0].innerHTML=e.nodeValue;break;case"data-tm-bgcolor":a(TomloprodModal.modal.getElementsByClassName("tm-wrapper"),"backgroundColor",e.nodeValue);break;case"data-tm-textcolor":a(TomloprodModal.modal.getElementsByClassName("tm-content"),"color",e.nodeValue),a(TomloprodModal.modal.getElementsByClassName("tm-wrapper"),"color",e.nodeValue);break;case"data-tm-closetimer":q=setTimeout(TomloprodModal.closeModal,e.nodeValue)}k&&b(TomloprodModal.modal,"tm-draggable")&&(TomloprodModal.modal.setAttribute("onmousedown","TomloprodModal.startDragging(this,event);"),TomloprodModal.modal.setAttribute("onmouseup","TomloprodModal.stopDragging(this);")),c(TomloprodModal.modal,"tm-showModal"),i=TomloprodModal.modal.querySelector(".tm-closeButton"),i.addEventListener("click",TomloprodModal.closeModal,!1),l&&!m&&document.querySelector(".tm-overlay").addEventListener("click",TomloprodModal.closeModal,!1),j&&(document.onkeyup=g),TomloprodModal.isOpen=!0,TomloprodModal.fire("opened")}else p&&console.error("TomloprodModal: Cannot find the indicated modal window.")},registerHandler:function(a,b){var c=!0;n[a]?d(n[a],b)===-1?n[a].push(b):(c=!1,console.error("TomloprodModal: The event ''"+a+"'' already contain one handler with the next function:\n\n "+b)):n[a]=[b],p&&c&&console.info("TomloprodModal: There are one new handler registered to the event ''"+a+"'':\n\n "+b+". \n\nTotal handlers of ''"+a+"'' event: "+n[a].length)},removeHandler:function(a,b){if(!n[a])return!1;if(b=b||!1){var c=d(n[a],b);return c>-1&&(n[a].splice(c,1),p&&console.info("TomloprodModal: The handlers with the name ''"+a+"'' have been deleted successfully. ("+b+")"),!0)}delete n[a],p&&console.info("TomloprodModal: The handler ''"+a+"'' has been deleted successfully. ("+b+")")},fire:function(a){if(!n[a])return p&&console.info("TomloprodModal: There aren't any handlers registered for ''"+a+"''"),!1;var b;for(b=0;b<n[a].length;b+=1)n[a][b].apply(window,Array.prototype.slice.call(arguments,1))},start:function(d){document.body.innerHTML+='<div class="tm-overlay"></div>';var e=null;if(void 0!==d)for(e in d)if(void 0!==d[e])switch(e){case"draggable":k=d[e];break;case"bgColor":a(document.getElementsByClassName("tm-wrapper"),"backgroundColor",d[e]);break;case"borderRadius":a(document.getElementsByClassName("tm-wrapper"),"-webkit-border-radius",d[e]),a(document.getElementsByClassName("tm-wrapper"),"-moz-border-radius",d[e]),a(document.getElementsByClassName("tm-wrapper"),"border-radius",d[e]);break;case"textColor":a(document.getElementsByClassName("tm-content"),"color",d[e]),a(document.getElementsByClassName("tm-wrapper"),"color",d[e]);break;case"closeOnOverlay":l=d[e];break;case"overlayColor":document.querySelector(".tm-overlay").style.backgroundColor=d[e];break;case"removeOverlay":d[e]&&(m=d[e],document.querySelector(".tm-overlay").parentNode.removeChild(document.querySelector(".tm-overlay")));break;case"showMessages":p=d[e];break;case"closeOnEsc":j=d[e];break;case"idMainContainer":o=document.getElementById(d[e]),c(o,"tm-MainContainer")}document.onclick=function(a){a=a||window.event,b(a.target,"tm-trigger")&&h(a,a)};for(var f=document.getElementsByTagName("A"),g=0;g<f.length;g++){var i=f[g];if(b(i,"tm-trigger")){var n=n||window.event;i.onclick=h.bind(i,n)}}},stop:function(){document.onclick=null;for(var a=document.getElementsByTagName("A"),b=0;b<a.length;b++){var c=a[b];c.onclick=null}},closeModal:function(a){if(void 0!==a&&a.stopPropagation(),window.clearTimeout(q),e(o,"tm-effect"),e(TomloprodModal.modal,"tm-showModal"),i.removeEventListener("click",TomloprodModal.closeModal,!1),TomloprodModal.isOpen){var b=TomloprodModal.modal.querySelectorAll(".tm-emptyOnClose"),c=0;for(c=0;c<b.length;c+=1)"INPUT"===b[c].tagName?b[c].value="":b[c].innerHTML=""}TomloprodModal.stopDragging(TomloprodModal.modal),TomloprodModal.modal=[],TomloprodModal.isOpen=!1,TomloprodModal.fire("closed")},startDragging:function(a,b){b=b||window.event,a.style.cursor="move";var d=a.offsetTop,e=a.offsetLeft,g=TomloprodModal.modal.offsetWidth/2,h=TomloprodModal.modal.offsetHeight/2,i=parseInt(window.innerWidth,10),j=parseInt(window.innerHeight,10),k=b.clientX-e,l=b.clientY-d;document.onmousemove=function(b){b=b||window.event;var d=b.clientX-k,e=b.clientY-l;d<g&&(d=g),d+g>i&&(d=i-g),e<h&&(e=h),e+h>j&&(e=j-h),c(document.getElementsByTagName("body")[0],"tm-avoidSelection"),c(TomloprodModal.modal,"tm-avoidSelection"),f(a,d,e)}},stopDragging:function(a){void 0!==a.style&&(a.style.cursor="default",e(document.getElementsByTagName("body")[0],"tm-avoidSelection"),e(TomloprodModal.modal,"tm-avoidSelection"),TomloprodModal.fire("stopDragging"),document.onmousemove=function(){})}}}();