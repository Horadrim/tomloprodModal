/*! tomloprodModal - v1.0.1 - 2016-09-12
* Copyright (c) 2016 Tomas Lopez; Licensed MIT */
var TomloprodModal=function(){"use strict";function a(a,b,c){[].forEach.call(a,function(a){a.style[b]=c})}function b(a,b){return a.classList?a.classList.contains(b):new RegExp("(^| )"+b+"( |$)","gi").test(a.className)}function c(a){try{if(a.getAttribute("data-tm-modal"))return a}catch(a){return a}for(;!a.getAttribute("data-tm-modal");)return c(a.parentNode)}function d(a,b){a.classList?a.classList.add(b):a.className+=" "+b}function e(a,b){var c=0,d=a.length;for(c=0;c<d;c+=1)if(a[c].toString()===b.toString())return c;return-1}function f(a,b){a.classList?a.classList.remove(b):void 0!==a.className&&(a.className=a.className.replace(new RegExp("(^|\\b)"+b.split(" ").join("|")+"(\\b|$)","gi")," "))}function g(a,b,c){a.style.left=b+"px",a.style.top=c+"px",q&&console.info("TomloprodModal: Dragging. Coord X: "+b+"px | Coord Y: "+c+"px")}function h(a){a=a||window.event,27===a.keyCode&&TomloprodModal.closeModal()}function i(a){if(a.target!==document.body){var d=c(a.target);d instanceof Element&&b(d,"tm-trigger")&&void 0!==d&&(TomloprodModal.openModal(d.getAttribute("data-tm-modal")),a.preventDefault())}}var j=null,k=!0,l=!0,m=!0,n=!1,o={},p=[],q=!1,r=null;return{modal:[],isOpen:!1,openModal:function(c){if(TomloprodModal.isOpen&&TomloprodModal.closeModal(),TomloprodModal.modal=document.getElementById(c),TomloprodModal.modal){p&&d(p,"tm-effect");for(var e=null,f=0;f<TomloprodModal.modal.attributes.length;f++)if(e=TomloprodModal.modal.attributes[f],/^data-/.test(e.nodeName))switch(e.nodeName){case"data-tm-content":TomloprodModal.modal.getElementsByClassName("tm-content")[0].innerHTML=e.nodeValue;break;case"data-tm-title":TomloprodModal.modal.getElementsByClassName("tm-title-text")[0].innerHTML=e.nodeValue;break;case"data-tm-bgcolor":a(TomloprodModal.modal.getElementsByClassName("tm-wrapper"),"backgroundColor",e.nodeValue);break;case"data-tm-textcolor":a(TomloprodModal.modal.getElementsByClassName("tm-content"),"color",e.nodeValue),a(TomloprodModal.modal.getElementsByClassName("tm-wrapper"),"color",e.nodeValue);break;case"data-tm-closetimer":r=setTimeout(TomloprodModal.closeModal,e.nodeValue)}l&&b(TomloprodModal.modal,"tm-draggable")&&(TomloprodModal.modal.setAttribute("onmousedown","TomloprodModal.startDragging(this,event);"),TomloprodModal.modal.setAttribute("onmouseup","TomloprodModal.stopDragging(this);")),d(TomloprodModal.modal,"tm-showModal"),j=TomloprodModal.modal.querySelector(".tm-closeButton"),j.addEventListener("click",TomloprodModal.closeModal,!1),m&&!n&&document.querySelector(".tm-overlay").addEventListener("click",TomloprodModal.closeModal,!1),k&&(document.onkeyup=h),TomloprodModal.isOpen=!0,TomloprodModal.fire("opened")}else q&&console.error("TomloprodModal: Cannot find the indicated modal window.")},registerHandler:function(a,b){var c=!0;o[a]?e(o[a],b)===-1?o[a].push(b):(c=!1,console.error("TomloprodModal: The event ''"+a+"'' already contain one handler with the next function:\n\n "+b)):o[a]=[b],q&&c&&console.info("TomloprodModal: There are one new handler registered to the event ''"+a+"'':\n\n "+b+". \n\nTotal handlers of ''"+a+"'' event: "+o[a].length)},removeHandler:function(a,b){if(!o[a])return!1;if(b=b||!1){var c=e(o[a],b);return c>-1&&(o[a].splice(c,1),q&&console.info("TomloprodModal: The handlers with the name ''"+a+"'' have been deleted successfully. ("+b+")"),!0)}delete o[a],q&&console.info("TomloprodModal: The handler ''"+a+"'' has been deleted successfully. ("+b+")")},fire:function(a){if(!o[a])return q&&console.info("TomloprodModal: There aren't any handlers registered for ''"+a+"''"),!1;var b;for(b=0;b<o[a].length;b+=1)o[a][b].apply(window,Array.prototype.slice.call(arguments,1))},start:function(b){document.body.innerHTML+='<div class="tm-overlay"></div>';var c=null;if(void 0!==b)for(c in b)if(void 0!==b[c])switch(c){case"draggable":l=b[c];break;case"bgColor":a(document.getElementsByClassName("tm-wrapper"),"backgroundColor",b[c]);break;case"borderRadius":a(document.getElementsByClassName("tm-wrapper"),"-webkit-border-radius",b[c]),a(document.getElementsByClassName("tm-wrapper"),"-moz-border-radius",b[c]),a(document.getElementsByClassName("tm-wrapper"),"border-radius",b[c]);break;case"textColor":a(document.getElementsByClassName("tm-content"),"color",b[c]),a(document.getElementsByClassName("tm-wrapper"),"color",b[c]);break;case"closeOnOverlay":m=b[c];break;case"overlayColor":document.querySelector(".tm-overlay").style.backgroundColor=b[c];break;case"removeOverlay":b[c]&&(n=b[c],document.querySelector(".tm-overlay").parentNode.removeChild(document.querySelector(".tm-overlay")));break;case"showMessages":q=b[c];break;case"closeOnEsc":k=b[c];break;case"idMainContainer":p=document.getElementById(b[c]),d(p,"tm-MainContainer")}document.addEventListener?document.addEventListener("click",i):document.attachEvent&&document.attachEvent("onclick",i)},stop:function(){document.onclick=null;for(var a=document.getElementsByTagName("A"),b=0;b<a.length;b++){var c=a[b];c.onclick=null}},closeModal:function(a){if(void 0!==a&&a.stopPropagation(),window.clearTimeout(r),f(p,"tm-effect"),f(TomloprodModal.modal,"tm-showModal"),j.removeEventListener("click",TomloprodModal.closeModal,!1),TomloprodModal.isOpen){var b=TomloprodModal.modal.querySelectorAll(".tm-emptyOnClose"),c=0;for(c=0;c<b.length;c+=1)"INPUT"===b[c].tagName?b[c].value="":b[c].innerHTML=""}TomloprodModal.stopDragging(TomloprodModal.modal),TomloprodModal.modal=[],TomloprodModal.isOpen=!1,TomloprodModal.fire("closed")},startDragging:function(a,b){b=b||window.event,a.style.cursor="move";var c=a.offsetTop,e=a.offsetLeft,f=TomloprodModal.modal.offsetWidth/2,h=TomloprodModal.modal.offsetHeight/2,i=parseInt(window.innerWidth,10),j=parseInt(window.innerHeight,10),k=b.clientX-e,l=b.clientY-c;document.onmousemove=function(b){b=b||window.event;var c=b.clientX-k,e=b.clientY-l;c<f&&(c=f),c+f>i&&(c=i-f),e<h&&(e=h),e+h>j&&(e=j-h),d(document.getElementsByTagName("body")[0],"tm-avoidSelection"),d(TomloprodModal.modal,"tm-avoidSelection"),g(a,c,e)}},stopDragging:function(a){void 0!==a.style&&(a.style.cursor="default",f(document.getElementsByTagName("body")[0],"tm-avoidSelection"),f(TomloprodModal.modal,"tm-avoidSelection"),TomloprodModal.fire("stopDragging"),document.onmousemove=function(){})}}}();